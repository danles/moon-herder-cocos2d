////  Moon.m//  MoonHerder////  Created by Roger Engelbert on 10/9/12.//  Copyright Done With Computers 2012. All rights reserved.//	#import "Moon.h"// Moon implementation@implementation Moon@synthesize blinking = _blinking, off = _off;- (void) dealloc {		[super dealloc];}-(id) initWithGame:(Game *) game withRadius:(int) radius {	self = [super initWithGame:game withRadius:radius];	if(self != nil) {				//timer for blinking         _blinkInterval = 2 * _game.screen_ratio;        _blinkTimer = 0;        _blinking = NO;        _blinkState = 1;        _off = NO;                _frame1 = [[CCSpriteFrameCache sharedSpriteFrameCache] spriteFrameByName:@"moon.png"];        _frame2 = [[CCSpriteFrameCache sharedSpriteFrameCache] spriteFrameByName:@"moon_off.png"];             _skin = [CCSprite spriteWithSpriteFrame:_frame1];	}		return self;}-(void) reset {    [super reset];    _off = NO;    _blinking = NO;    _blinkTimer = 0;    _blinkState = 1;    [_skin setDisplayFrame:_frame1];}-(void) update:(float) dt {	    dt *= _game.screen_ratio;    	_vy -= 0.2;    	[self limitSpeeds];		_nextX = _skin.position.x + _vx * dt;	_nextY = _skin.position.y + _vy * dt;		//if hitting sides of screen	if (_nextX < _radius) {		_nextX = _radius ;		_vx *= -1.0;		//I play the same sound as when sun is hit        [[SimpleAudioEngine sharedEngine] playEffect:@"sun_hit.wav"];	}	if (_nextX > _game.screenWidth - _radius) {		_nextX = _game.screenWidth - _radius ;		_vx *= -1.0;        [[SimpleAudioEngine sharedEngine] playEffect:@"sun_hit.wav"];	}		//rotate moon based on VX	_skin.rotation += _vx * 0.08f;        //moon blinks when power is boosting    if (_blinking) {        _blinkTimer += dt;        if (_blinkTimer > _blinkInterval) {            _blinkTimer = 0;                        if (_blinkState == 1) {                _blinkState = 0;                [_skin setDisplayFrame:_frame2];            } else {                _blinkState = 1;                [_skin setDisplayFrame:_frame1];            }        }    }    }//moon is shown without halo, when power runs out-(void) turnOnOff:(BOOL) value {    if (value) {        _off = NO;        _blinkState = 1;        [_skin setDisplayFrame:_frame1];    } else {        _off = YES;        _blinkState = 0;        [_skin setDisplayFrame:_frame2];    }}-(void) limitSpeeds {	if (_vx > _terminal_velocity) _vx = _terminal_velocity;	if (_vx < -_terminal_velocity) _vx = -_terminal_velocity;	if (_vy > _terminal_velocity) _vy = _terminal_velocity;	if (_vy < -_terminal_velocity) _vy = -_terminal_velocity;}@end		